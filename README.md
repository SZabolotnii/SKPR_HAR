# HAR-SKPR: Human Activity Recognition using Statistical Pattern Recognition in Kunchenko Space

## Опис проекту

Цей проект містить реалізацію та експериментальну валідацію методу статистичного розпізнавання образів у просторі з порідним елементом (СКПР/SKPR) для задачі розпізнавання активності людини на основі даних сенсорів смартфона.

## Вимоги

- Python 3.8+
- NumPy
- Scikit-learn
- Matplotlib
- Seaborn
- Pandas
- Jupyter (опціонально, для notebooks)

## Встановлення

```bash
git clone https://github.com/SZabolotnii/SKPR_HAR
cd SKPR_HAR
pip install -r requirements.txt
```

## Структура експериментів

### Експеримент 1: Базовий метод SKPR (неоптимізований)
- Генерація 6 агрегованих ознак на основі похибки реконструкції
- Класифікація за допомогою SVM з базовими параметрами (n=4, α=1)
- **Результат: 77.71% точності**

### Експеримент 2: Ансамбль експертів
- Порівняння 4 різних типів базисних функцій:
  - Поліноміальний (x², x³, x⁴): 76.04%
  - Тригонометричний (sin(x), sin(2x), sin(3x)): 78.76%
  - Робастний (tanh(x), sigmoid(x), atan(x)): 81.40%
  - Дробово-степеневий (sign(x)·|x|^(1/2), sign(x)·|x|^(1/3), sign(x)·|x|^(1/4)): **82.59%**
- Ансамбль всіх 4 типів (24 ознаки): **84.63%**

### Експеримент 3: Оптимізація параметрів базису
- Grid search для пошуку оптимальних параметрів дробово-степеневого базису
- Знайдено оптимальні параметри: n=3, α=0.0
- Валідаційна точність: 83.41%
- **Тестова точність: 84.36%**

### Експеримент 4: Гібридна модель
- Поєднання 6 ознак SKPR + 24 найкращі традиційні ознаки
- Відбір традиційних ознак за допомогою Random Forest
- Оптимізація параметрів SVM: C=100, γ=0.01
- **Результат: 88.46% точності**

### Експеримент 5: Інкрементальна валідація
- Додавання 6 ознак SKPR до повного набору з 561 традиційної ознаки
- Тест МакНемара для статистичної значущості
- **Результат: покращення з 95.72% до 95.86% (+0.14%)**
- Виправлено 7 помилок (всі пов'язані з розрізненням SITTING/STANDING)

## Запуск експериментів

### Всі експерименти одночасно:
```bash
python run_all_experiments.py
```

### Окремі експерименти:
```bash
python experiments/exp1_basic_skpr.py
python experiments/exp2_ensemble_analysis.py
python experiments/exp3_optimal_basis.py
python experiments/exp4_hybrid_model.py
python experiments/exp5_full_validation.py
```

## Структура даних

Проект автоматично завантажує датасет UCI HAR Dataset, який містить:
- 9 сигналів сенсорів (3-осьові акселерометр тіла, гіроскоп, загальне прискорення)
- 6 класів активності: WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, LAYING
- 7352 тренувальних зразків, 2947 тестових зразків
- Сегментація вікнами по 2.56 секунди (128 відліків) з 50% перекриттям

## Ключові результати

| Експеримент | Конфігурація | Точність | Особливості |
|-------------|--------------|----------|-------------|
| 1. Базовий | 6 ознак (неоптимізовано) | 77.71% | Демонстрація потенціалу |
| 2. Ансамбль | 24 ознаки (4 типи базису) | 84.63% | Найкращий результат ансамблю |
| 3. Оптимізований | 6 ознак (n=3, α=0.0) | 84.36% | Оптимальна ефективність |
| 4. Гібридний | 30 ознак (6 СКПР + 24 традиційних) | 88.46% | Найвищий результат |
| 5. Інкрементальний | 567 ознак (561 + 6 СКПР) | 95.86% | Комплементарність |

## Оптимальна конфігурація

Найкращі параметри для дробово-степеневого базису:
- **n = 3** (кількість базисних функцій)
- **α = 0.0** (параметр для обчислення степенів)
- **λ = 0.01** (параметр регуляризації)

Базисні функції:
- φ₁(x) = sign(x)·|x|^(1/2)
- φ₂(x) = sign(x)·|x|^(1/3)  
- φ₃(x) = sign(x)·|x|^(1/4)

## Результати

Всі результати зберігаються в директорії `results/`:
- `figures/` - матриці плутанини, графіки порівняння та візуалізації
- `models/` - навчені моделі у форматі pickle
- `reports/` - детальні звіти класифікації та статистичний аналіз

## Практичне застосування

Метод підходить для:
- Системи реального часу на мобільних пристроях (завдяки компактності 6 ознак)
- Покращення існуючих HAR систем (через гібридний підхід)
- Розрізнення статичних активностей (SITTING/STANDING)
- Енергоефективний моніторинг активності

## Цитування

Якщо ви використовуєте цей код у своїх дослідженнях, будь ласка, посилайтесь на:

```
@article{zabolotnii2024har,
  title={Статистичне розпізнавання образів у просторі з порідним елементом для класифікації активності людини за допомогою сенсорів смартфона},
  author={Заболотній, С.В.},
  journal={...},
  year={2024}
}
```

## Ліцензія

MIT License